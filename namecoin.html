<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Namecoin Cold Wallet Generator</title>
  <meta name="description"
    content="A lightweight, client-side, reliable, fast, open-source universal cold wallet generator supporting almost every major cryptocurrency">
  <meta name="keywords"
    content="minimal, reliable, fast, universal, cold, wallet, generator, offline, namecoin, cryptocurrency">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="css/style2.css">
</head>

<body onload="generate()">
  <div class="container">
        <h1>Namecoin Cold Wallet</h1>
        <div class="button-group">
            <button onclick="window.location.href='index.html'">Home</button>
            <button onclick="generate()">Generate</button>
            <button onclick="window.print()">Print</button>
        </div>
        <div class="info-box">
            <label>Public Address (SHARE)</label>
            <span id="public">Click Generate to create wallet</span>
            <div id="public_qr" class="qr-code"></div>
        </div>
        <div class="info-box">
            <label>Mnemonic Seed (SECRET)</label>
            <span id="secret">Click Generate to create wallet</span>
            <div id="secret_qr" class="qr-code"></div>
        </div>
    </div>
  <script src="js/bitcoinjs-lib.js"></script>
  <script src="js/bip39.min.js"></script>
  <script src="js/qrcode.js"></script>
  <script>
    async function generate() {
        // Generate a 24-word mnemonic
        const mnemonic = bip39.generateMnemonic(256);

        // Derive seed from mnemonic
        const seed = await bip39.mnemonicToSeed(mnemonic);

        // Namecoin network params
        const namecoin = {
          messagePrefix: '\x19Namecoin Signed Message:\n',
          bech32: '',
          bip32: {
            public: 0x0488B21E,
            private: 0x0488ADE4,
          },
          pubKeyHash: 0x34,
          scriptHash: 0x08,
          wif: 0xB4,
        };

        // Derive root and first account: m/44'/7'/0'/0/0 (Namecoin BIP44, coin_type is 7)
        const root = bitcoin.bip32.fromSeed(seed, namecoin);
        const child = root.derivePath("m/44'/7'/0'/0/0");

        const { address } = bitcoin.payments.p2pkh({pubkey: child.publicKey, network: namecoin});

        const publicElem = document.getElementById("public");
        const mnemonicElem = document.getElementById("secret");
        const publicQRElem = document.getElementById("public_qr");
        const mnemonicQRElem = document.getElementById("secret_qr");

        if (publicElem && mnemonicElem && publicQRElem && mnemonicQRElem) {
          publicElem.textContent = address;
          mnemonicElem.textContent = mnemonic;

          publicQRElem.innerHTML = "";
          mnemonicQRElem.innerHTML = "";

          new QRCode(publicQRElem, {
            text: address,
            width: 100,
            height: 100,
            colorDark: "#e0e0e0",
            colorLight: "#1e1e1e",
            correctLevel: QRCode.CorrectLevel.H,
          });

          new QRCode(mnemonicQRElem, {
            text: mnemonic,
            width: 100,
            height: 100,
            colorDark: "#e0e0e0",
            colorLight: "#1e1e1e",
            correctLevel: QRCode.CorrectLevel.H,
          });
        }
      }
  </script>
</body>

</html>