var alphabet="13456789abcdefghijkmnopqrstuwxyz";function encode(a){if(a.constructor!==Uint8Array)throw Error("View must be a Uint8Array!");var c=a.length,b=8*c%5;b=0===b?0:5-b;for(var d=0,f="",e=0,h=0;h<c;h++)for(d=d<<8|a[h],e+=8;5<=e;)f+=alphabet[d>>>e+b-5&31],e-=5;0<e&&(f+=alphabet[d<<5-(e+b)&31]);return f}var ERROR_MSG_INPUT="Input must be an string, Buffer or Uint8Array";function normalizeInput(a){if(!(a instanceof Uint8Array))throw Error(ERROR_MSG_INPUT);return a}
function toHex(a){return Array.prototype.map.call(a,function(c){return(16>c?"0":"")+c.toString(16)}).join("")}function uint32ToHex(a){return(4294967296+a).toString(16).substring(1)}function ADD64AA(a,c,b){var d=a[c]+a[b];b=a[c+1]+a[b+1];4294967296<=d&&b++;a[c]=d;a[c+1]=b}function ADD64AC(a,c,b,d){var f=a[c]+b;0>b&&(f+=4294967296);b=a[c+1]+d;4294967296<=f&&b++;a[c]=f;a[c+1]=b}function B2B_GET32(a,c){return a[c]^a[c+1]<<8^a[c+2]<<16^a[c+3]<<24}
function B2B_G(a,c,b,d,f,e){var h=m[f],g=m[f+1];f=m[e];e=m[e+1];ADD64AA(v,a,c);ADD64AC(v,a,h,g);h=v[d]^v[a];g=v[d+1]^v[a+1];v[d]=g;v[d+1]=h;ADD64AA(v,b,d);h=v[c]^v[b];g=v[c+1]^v[b+1];v[c]=h>>>24^g<<8;v[c+1]=g>>>24^h<<8;ADD64AA(v,a,c);ADD64AC(v,a,f,e);h=v[d]^v[a];g=v[d+1]^v[a+1];v[d]=h>>>16^g<<16;v[d+1]=g>>>16^h<<16;ADD64AA(v,b,d);h=v[c]^v[b];g=v[c+1]^v[b+1];v[c]=g>>>31^h<<1;v[c+1]=h>>>31^g<<1}
var BLAKE2B_IV32=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),SIGMA8=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,
9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],SIGMA82=new Uint8Array(SIGMA8.map(function(a){return 2*a})),v=new Uint32Array(32),m=new Uint32Array(32);
function blake2bCompress(a,c){var b;for(b=0;16>b;b++)v[b]=a.h[b],v[b+16]=BLAKE2B_IV32[b];v[24]^=a.t;v[25]^=a.t/4294967296;c&&(v[28]=~v[28],v[29]=~v[29]);for(b=0;32>b;b++)m[b]=B2B_GET32(a.b,4*b);for(b=0;12>b;b++)B2B_G(0,8,16,24,SIGMA82[16*b],SIGMA82[16*b+1]),B2B_G(2,10,18,26,SIGMA82[16*b+2],SIGMA82[16*b+3]),B2B_G(4,12,20,28,SIGMA82[16*b+4],SIGMA82[16*b+5]),B2B_G(6,14,22,30,SIGMA82[16*b+6],SIGMA82[16*b+7]),B2B_G(0,10,20,30,SIGMA82[16*b+8],SIGMA82[16*b+9]),B2B_G(2,12,22,24,SIGMA82[16*b+10],SIGMA82[16*
b+11]),B2B_G(4,14,16,26,SIGMA82[16*b+12],SIGMA82[16*b+13]),B2B_G(6,8,18,28,SIGMA82[16*b+14],SIGMA82[16*b+15]);for(b=0;16>b;b++)a.h[b]=a.h[b]^v[b]^v[b+16]}
function blake2bInit(a,c){if(0===a||64<a)throw Error("Illegal output length, expected 0 < length <= 64");if(c&&64<c.length)throw Error("Illegal key, expected Uint8Array with 0 < length <= 64");for(var b={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:a},d=0;16>d;d++)b.h[d]=BLAKE2B_IV32[d];b.h[0]=b.h[0]^16842752^(c?c.length:0)<<8^a;c&&(blake2bUpdate(b,c),b.c=128);return b}
function blake2bUpdate(a,c){for(var b=0;b<c.length;b++)128===a.c&&(a.t+=a.c,blake2bCompress(a,!1),a.c=0),a.b[a.c++]=c[b]}function blake2bFinal(a){for(a.t+=a.c;128>a.c;)a.b[a.c++]=0;blake2bCompress(a,!0);for(var c=new Uint8Array(a.outlen),b=0;b<a.outlen;b++)c[b]=a.h[b>>2]>>8*(b&3);return c}function blake2b(a,c,b){b=b||64;a=normalizeInput(a);c=blake2bInit(b,c);blake2bUpdate(c,a);return blake2bFinal(c)}function blake2bHex(a,c,b){a=blake2b(a,c,b);return toHex(a)}
var u64=function(a,c){this.hi=a|0;this.lo=c|0},gf=function(a){var c,b=new Float64Array(16);if(a)for(c=0;c<a.length;c++)b[c]=a[c];return b},randombytes=function(){throw Error("no PRNG");},_0=new Uint8Array(16),_9=new Uint8Array(32);_9[0]=9;
var gf0=gf(),gf1=gf([1]),_121665=gf([56129,1]),D=gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),D2=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),X=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Y=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),I=gf([41136,18958,6951,50414,58488,44335,6150,12099,
55207,15867,153,11085,57099,20417,9344,11139]);function L32(a,c){return a<<c|a>>>32-c}function ld32(a,c){var b=a[c+3]&255;b=b<<8|a[c+2]&255;b=b<<8|a[c+1]&255;return b<<8|a[c+0]&255}function dl64(a,c){return new u64(a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7])}function st32(a,c,b){var d;for(d=0;4>d;d++)a[c+d]=b&255,b>>>=8}
function ts64(a,c,b){a[c]=b.hi>>24&255;a[c+1]=b.hi>>16&255;a[c+2]=b.hi>>8&255;a[c+3]=b.hi&255;a[c+4]=b.lo>>24&255;a[c+5]=b.lo>>16&255;a[c+6]=b.lo>>8&255;a[c+7]=b.lo&255}function vn(a,c,b,d,f){var e,h=0;for(e=0;e<f;e++)h|=a[c+e]^b[d+e];return(1&h-1>>>8)-1}function crypto_verify_16(a,c,b,d){return vn(a,c,b,d,16)}function crypto_verify_32(a,c,b,d){return vn(a,c,b,d,32)}
function core(a,c,b,d,f){var e=new Uint32Array(16),h=new Uint32Array(16),g=new Uint32Array(16),l=new Uint32Array(4),k,n;for(k=0;4>k;k++)h[5*k]=ld32(d,4*k),h[1+k]=ld32(b,4*k),h[6+k]=ld32(c,4*k),h[11+k]=ld32(b,16+4*k);for(k=0;16>k;k++)g[k]=h[k];for(k=0;20>k;k++){for(b=0;4>b;b++){for(n=0;4>n;n++)l[n]=h[(5*b+4*n)%16];l[1]^=L32(l[0]+l[3]|0,7);l[2]^=L32(l[1]+l[0]|0,9);l[3]^=L32(l[2]+l[1]|0,13);l[0]^=L32(l[3]+l[2]|0,18);for(n=0;4>n;n++)e[4*b+(b+n)%4]=l[n]}for(n=0;16>n;n++)h[n]=e[n]}if(f){for(k=0;16>k;k++)h[k]=
h[k]+g[k]|0;for(k=0;4>k;k++)h[5*k]=h[5*k]-ld32(d,4*k)|0,h[6+k]=h[6+k]-ld32(c,4*k)|0;for(k=0;4>k;k++)st32(a,4*k,h[5*k]),st32(a,16+4*k,h[6+k])}else for(k=0;16>k;k++)st32(a,4*k,h[k]+g[k]|0)}function crypto_core_salsa20(a,c,b,d){core(a,c,b,d,!1);return 0}function crypto_core_hsalsa20(a,c,b,d){core(a,c,b,d,!0);return 0}var sigma=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);
function crypto_stream_salsa20_xor(a,c,b,d,f,e,h){var g=new Uint8Array(16),l=new Uint8Array(64),k;if(!f)return 0;for(k=0;16>k;k++)g[k]=0;for(k=0;8>k;k++)g[k]=e[k];for(;64<=f;){crypto_core_salsa20(l,g,h,sigma);for(k=0;64>k;k++)a[c+k]=(b?b[d+k]:0)^l[k];e=1;for(k=8;16>k;k++)e=e+(g[k]&255)|0,g[k]=e&255,e>>>=8;f-=64;c+=64;b&&(d+=64)}if(0<f)for(crypto_core_salsa20(l,g,h,sigma),k=0;k<f;k++)a[c+k]=(b?b[d+k]:0)^l[k];return 0}
function crypto_stream_salsa20(a,c,b,d,f){return crypto_stream_salsa20_xor(a,c,null,0,b,d,f)}function crypto_stream(a,c,b,d,f){var e=new Uint8Array(32);crypto_core_hsalsa20(e,d,f,sigma);return crypto_stream_salsa20(a,c,b,d.subarray(16),e)}function crypto_stream_xor(a,c,b,d,f,e,h){var g=new Uint8Array(32);crypto_core_hsalsa20(g,e,h,sigma);return crypto_stream_salsa20_xor(a,c,b,d,f,e.subarray(16),g)}function add1305(a,c){var b,d=0;for(b=0;17>b;b++)d=d+(a[b]+c[b]|0)|0,a[b]=d&255,d>>>=8}
var minusp=new Uint32Array([5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,252]);
function crypto_onetimeauth(a,c,b,d,f,e){var h,g,l=new Uint32Array(17),k=new Uint32Array(17),n=new Uint32Array(17),p=new Uint32Array(17),q=new Uint32Array(17);for(g=0;17>g;g++)k[g]=n[g]=0;for(g=0;16>g;g++)k[g]=e[g];k[3]&=15;k[4]&=252;k[7]&=15;k[8]&=252;k[11]&=15;k[12]&=252;for(k[15]&=15;0<f;){for(g=0;17>g;g++)p[g]=0;for(g=0;16>g&&g<f;++g)p[g]=b[d+g];p[g]=1;d+=g;f-=g;add1305(n,p);for(h=0;17>h;h++)for(g=l[h]=0;17>g;g++)l[h]=l[h]+n[g]*(g<=h?k[h-g]:320*k[h+17-g]|0)|0;for(h=0;17>h;h++)n[h]=l[h];for(g=
h=0;16>g;g++)h=h+n[g]|0,n[g]=h&255,h>>>=8;h=h+n[16]|0;n[16]=h&3;h=5*(h>>>2)|0;for(g=0;16>g;g++)h=h+n[g]|0,n[g]=h&255,h>>>=8;h=h+n[16]|0;n[16]=h}for(g=0;17>g;g++)q[g]=n[g];add1305(n,minusp);b=-(n[16]>>>7)|0;for(g=0;17>g;g++)n[g]^=b&(q[g]^n[g]);for(g=0;16>g;g++)p[g]=e[g+16];p[16]=0;add1305(n,p);for(g=0;16>g;g++)a[c+g]=n[g];return 0}function crypto_onetimeauth_verify(a,c,b,d,f,e){var h=new Uint8Array(16);crypto_onetimeauth(h,0,b,d,f,e);return crypto_verify_16(a,c,h,0)}
function crypto_secretbox(a,c,b,d,f){if(32>b)return-1;crypto_stream_xor(a,0,c,0,b,d,f);crypto_onetimeauth(a,16,a,32,b-32,a);for(c=0;16>c;c++)a[c]=0;return 0}function crypto_secretbox_open(a,c,b,d,f){var e=new Uint8Array(32);if(32>b)return-1;crypto_stream(e,0,32,d,f);if(0!==crypto_onetimeauth_verify(c,16,c,32,b-32,e))return-1;crypto_stream_xor(a,0,c,0,b,d,f);for(c=0;32>c;c++)a[c]=0;return 0}function set25519(a,c){var b;for(b=0;16>b;b++)a[b]=c[b]|0}
function car25519(a){var c;for(c=0;16>c;c++){a[c]+=65536;var b=Math.floor(a[c]/65536);a[(c+1)*(15>c?1:0)]+=b-1+37*(b-1)*(15===c?1:0);a[c]-=65536*b}}function sel25519(a,c,b){for(var d=~(b-1),f=0;16>f;f++)b=d&(a[f]^c[f]),a[f]^=b,c[f]^=b}
function pack25519(a,c){var b,d,f=gf(),e=gf();for(b=0;16>b;b++)e[b]=c[b];car25519(e);car25519(e);car25519(e);for(d=0;2>d;d++){f[0]=e[0]-65517;for(b=1;15>b;b++)f[b]=e[b]-65535-(f[b-1]>>16&1),f[b-1]&=65535;f[15]=e[15]-32767-(f[14]>>16&1);b=f[15]>>16&1;f[14]&=65535;sel25519(e,f,1-b)}for(b=0;16>b;b++)a[2*b]=e[b]&255,a[2*b+1]=e[b]>>8}function neq25519(a,c){var b=new Uint8Array(32),d=new Uint8Array(32);pack25519(b,a);pack25519(d,c);return crypto_verify_32(b,0,d,0)}
function par25519(a){var c=new Uint8Array(32);pack25519(c,a);return c[0]&1}function unpack25519(a,c){var b;for(b=0;16>b;b++)a[b]=c[2*b]+(c[2*b+1]<<8);a[15]&=32767}function A(a,c,b){var d;for(d=0;16>d;d++)a[d]=c[d]+b[d]|0}function Z(a,c,b){var d;for(d=0;16>d;d++)a[d]=c[d]-b[d]|0}function M(a,c,b){var d,f,e=new Float64Array(31);for(d=0;31>d;d++)e[d]=0;for(d=0;16>d;d++)for(f=0;16>f;f++)e[d+f]+=c[d]*b[f];for(d=0;15>d;d++)e[d]+=38*e[d+16];for(d=0;16>d;d++)a[d]=e[d];car25519(a);car25519(a)}
function S(a,c){M(a,c,c)}function inv25519(a,c){var b=gf(),d;for(d=0;16>d;d++)b[d]=c[d];for(d=253;0<=d;d--)S(b,b),2!==d&&4!==d&&M(b,b,c);for(d=0;16>d;d++)a[d]=b[d]}function pow2523(a,c){var b=gf(),d;for(d=0;16>d;d++)b[d]=c[d];for(d=250;0<=d;d--)S(b,b),1!==d&&M(b,b,c);for(d=0;16>d;d++)a[d]=b[d]}
function crypto_scalarmult(a,c,b){var d=new Uint8Array(32),f=new Float64Array(80),e,h=gf(),g=gf(),l=gf(),k=gf(),n=gf(),p=gf();for(e=0;31>e;e++)d[e]=c[e];d[31]=c[31]&127|64;d[0]&=248;unpack25519(f,b);for(e=0;16>e;e++)g[e]=f[e],k[e]=h[e]=l[e]=0;h[0]=k[0]=1;for(e=254;0<=e;--e)c=d[e>>>3]>>>(e&7)&1,sel25519(h,g,c),sel25519(l,k,c),A(n,h,l),Z(h,h,l),A(l,g,k),Z(g,g,k),S(k,n),S(p,h),M(h,l,h),M(l,g,n),A(n,h,l),Z(h,h,l),S(g,h),Z(l,k,p),M(h,l,_121665),A(h,h,k),M(l,l,h),M(h,k,p),M(k,g,f),S(g,n),sel25519(h,g,c),
sel25519(l,k,c);for(e=0;16>e;e++)f[e+16]=h[e],f[e+32]=l[e],f[e+48]=g[e],f[e+64]=k[e];d=f.subarray(32);f=f.subarray(16);inv25519(d,d);M(f,f,d);pack25519(a,f);return 0}function crypto_scalarmult_base(a,c){return crypto_scalarmult(a,c,_9)}function crypto_box_keypair(a,c){randombytes(c,32);return crypto_scalarmult_base(a,c)}function crypto_box_beforenm(a,c,b){var d=new Uint8Array(32);crypto_scalarmult(d,b,c);return crypto_core_hsalsa20(a,_0,d,sigma)}
var crypto_box_afternm=crypto_secretbox,crypto_box_open_afternm=crypto_secretbox_open;function crypto_box(a,c,b,d,f,e){var h=new Uint8Array(32);crypto_box_beforenm(h,f,e);return crypto_box_afternm(a,c,b,d,h)}function crypto_box_open(a,c,b,d,f,e){var h=new Uint8Array(32);crypto_box_beforenm(h,f,e);return crypto_box_open_afternm(a,c,b,d,h)}
function add64(){var a=0,c=0,b=0,d=0,f;for(f=0;f<arguments.length;f++){var e=arguments[f].lo;var h=arguments[f].hi;a+=e&65535;c+=e>>>16;b+=h&65535;d+=h>>>16}c+=a>>>16;b+=c>>>16;return new u64(b&65535|d+(b>>>16)<<16,a&65535|c<<16)}function shr64(a,c){return new u64(a.hi>>>c,a.lo>>>c|a.hi<<32-c)}function xor64(){var a=0,c=0,b;for(b=0;b<arguments.length;b++)a^=arguments[b].lo,c^=arguments[b].hi;return new u64(c,a)}
function R(a,c){var b=32-c;if(32>c){var d=a.hi>>>c|a.lo<<b;var f=a.lo>>>c|a.hi<<b}else 64>c&&(d=a.lo>>>c|a.hi<<b,f=a.hi>>>c|a.lo<<b);return new u64(d,f)}function Ch(a,c,b){return new u64(a.hi&c.hi^~a.hi&b.hi,a.lo&c.lo^~a.lo&b.lo)}function Maj(a,c,b){return new u64(a.hi&c.hi^a.hi&b.hi^c.hi&b.hi,a.lo&c.lo^a.lo&b.lo^c.lo&b.lo)}function Sigma0(a){return xor64(R(a,28),R(a,34),R(a,39))}function Sigma1(a){return xor64(R(a,14),R(a,18),R(a,41))}function sigma0(a){return xor64(R(a,1),R(a,8),shr64(a,7))}
function sigma1(a){return xor64(R(a,19),R(a,61),shr64(a,6))}
var K=[new u64(1116352408,3609767458),new u64(1899447441,602891725),new u64(3049323471,3964484399),new u64(3921009573,2173295548),new u64(961987163,4081628472),new u64(1508970993,3053834265),new u64(2453635748,2937671579),new u64(2870763221,3664609560),new u64(3624381080,2734883394),new u64(310598401,1164996542),new u64(607225278,1323610764),new u64(1426881987,3590304994),new u64(1925078388,4068182383),new u64(2162078206,991336113),new u64(2614888103,633803317),new u64(3248222580,3479774868),new u64(3835390401,
2666613458),new u64(4022224774,944711139),new u64(264347078,2341262773),new u64(604807628,2007800933),new u64(770255983,1495990901),new u64(1249150122,1856431235),new u64(1555081692,3175218132),new u64(1996064986,2198950837),new u64(2554220882,3999719339),new u64(2821834349,766784016),new u64(2952996808,2566594879),new u64(3210313671,3203337956),new u64(3336571891,1034457026),new u64(3584528711,2466948901),new u64(113926993,3758326383),new u64(338241895,168717936),new u64(666307205,1188179964),new u64(773529912,
1546045734),new u64(1294757372,1522805485),new u64(1396182291,2643833823),new u64(1695183700,2343527390),new u64(1986661051,1014477480),new u64(2177026350,1206759142),new u64(2456956037,344077627),new u64(2730485921,1290863460),new u64(2820302411,3158454273),new u64(3259730800,3505952657),new u64(3345764771,106217008),new u64(3516065817,3606008344),new u64(3600352804,1432725776),new u64(4094571909,1467031594),new u64(275423344,851169720),new u64(430227734,3100823752),new u64(506948616,1363258195),
new u64(659060556,3750685593),new u64(883997877,3785050280),new u64(958139571,3318307427),new u64(1322822218,3812723403),new u64(1537002063,2003034995),new u64(1747873779,3602036899),new u64(1955562222,1575990012),new u64(2024104815,1125592928),new u64(2227730452,2716904306),new u64(2361852424,442776044),new u64(2428436474,593698344),new u64(2756734187,3733110249),new u64(3204031479,2999351573),new u64(3329325298,3815920427),new u64(3391569614,3928383900),new u64(3515267271,566280711),new u64(3940187606,
3454069534),new u64(4118630271,4000239992),new u64(116418474,1914138554),new u64(174292421,2731055270),new u64(289380356,3203993006),new u64(460393269,320620315),new u64(685471733,587496836),new u64(852142971,1086792851),new u64(1017036298,365543100),new u64(1126000580,2618297676),new u64(1288033470,3409855158),new u64(1501505948,4234509866),new u64(1607167915,987167468),new u64(1816402316,1246189591)];
function crypto_hashblocks(a,c,b){var d=[],f=[],e=[],h=[],g,l;for(l=0;8>l;l++)d[l]=e[l]=dl64(a,8*l);for(var k=0;128<=b;){for(l=0;16>l;l++)h[l]=dl64(c,8*l+k);for(l=0;80>l;l++){for(g=0;8>g;g++)f[g]=e[g];g=add64(e[7],Sigma1(e[4]),Ch(e[4],e[5],e[6]),K[l],h[l%16]);f[7]=add64(g,Sigma0(e[0]),Maj(e[0],e[1],e[2]));f[3]=add64(f[3],g);for(g=0;8>g;g++)e[(g+1)%8]=f[g];if(15===l%16)for(g=0;16>g;g++)h[g]=add64(h[g],h[(g+9)%16],sigma0(h[(g+1)%16]),sigma1(h[(g+14)%16]))}for(l=0;8>l;l++)e[l]=add64(e[l],d[l]),d[l]=
e[l];k+=128;b-=128}for(l=0;8>l;l++)ts64(a,8*l,d[l]);return b}var iv=new Uint8Array([106,9,230,103,243,188,201,8,187,103,174,133,132,202,167,59,60,110,243,114,254,148,248,43,165,79,245,58,95,29,54,241,81,14,82,127,173,230,130,209,155,5,104,140,43,62,108,31,31,131,217,171,251,65,189,107,91,224,205,25,19,126,33,121]);
function crypto_hash(a,c,b){var d=new Uint8Array(64),f=new Uint8Array(256),e,h=b;for(e=0;64>e;e++)d[e]=iv[e];crypto_hashblocks(d,c,b);b%=128;for(e=0;256>e;e++)f[e]=0;for(e=0;e<b;e++)f[e]=c[h-b+e];f[b]=128;b=256-128*(112>b?1:0);f[b-9]=0;ts64(f,b-8,new u64(h/536870912|0,h<<3));crypto_hashblocks(d,f,b);for(e=0;64>e;e++)a[e]=d[e];return 0}
function add(a,c){var b=gf(),d=gf(),f=gf(),e=gf(),h=gf(),g=gf(),l=gf(),k=gf(),n=gf();Z(b,a[1],a[0]);Z(n,c[1],c[0]);M(b,b,n);A(d,a[0],a[1]);A(n,c[0],c[1]);M(d,d,n);M(f,a[3],c[3]);M(f,f,D2);M(e,a[2],c[2]);A(e,e,e);Z(h,d,b);Z(g,e,f);A(l,e,f);A(k,d,b);M(a[0],h,g);M(a[1],k,l);M(a[2],l,g);M(a[3],h,k)}function cswap(a,c,b){var d;for(d=0;4>d;d++)sel25519(a[d],c[d],b)}function pack(a,c){var b=gf(),d=gf(),f=gf();inv25519(f,c[2]);M(b,c[0],f);M(d,c[1],f);pack25519(a,d);a[31]^=par25519(b)<<7}
function scalarmult(a,c,b){var d;set25519(a[0],gf0);set25519(a[1],gf1);set25519(a[2],gf1);set25519(a[3],gf0);for(d=255;0<=d;--d){var f=b[d/8|0]>>(d&7)&1;cswap(a,c,f);add(c,a);add(a,a);cswap(a,c,f)}}function scalarbase(a,c){var b=[gf(),gf(),gf(),gf()];set25519(b[0],X);set25519(b[1],Y);set25519(b[2],gf1);M(b[3],X,Y);scalarmult(a,b,c)}
function crypto_sign_keypair(a,c,b){new Uint8Array(64);var d=[gf(),gf(),gf(),gf()];b||randombytes(c,32);b=blake2bInit(64);blake2bUpdate(b,c);c=blake2bFinal(b);c[0]&=248;c[31]&=127;c[31]|=64;scalarbase(d,c);pack(a,d);return 0}function derivePublicFromSecret(a){new Uint8Array(64);var c=[gf(),gf(),gf(),gf()],b=new Uint8Array(32),d=blake2bInit(64);blake2bUpdate(d,a);a=blake2bFinal(d);a[0]&=248;a[31]&=127;a[31]|=64;scalarbase(c,a);pack(b,c);return b}
var L=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function modL(a,c){var b,d;for(b=63;32<=b;--b){var f=0;var e=b-32;for(d=b-12;e<d;++e)c[e]+=f-16*c[b]*L[e-(b-32)],f=c[e]+128>>8,c[e]-=256*f;c[e]+=f;c[b]=0}for(e=f=0;32>e;e++)c[e]+=f-(c[31]>>4)*L[e],f=c[e]>>8,c[e]&=255;for(e=0;32>e;e++)c[e]-=f*L[e];for(b=0;32>b;b++)c[b+1]+=c[b]>>8,a[b]=c[b]&255}
function reduce(a){var c=new Float64Array(64),b;for(b=0;64>b;b++)c[b]=a[b];for(b=0;64>b;b++)a[b]=0;modL(a,c)}
function crypto_sign(a,c,b,d){new Uint8Array(64);new Uint8Array(64);new Uint8Array(64);var f=new Float64Array(64);var e=[gf(),gf(),gf(),gf()];var h=derivePublicFromSecret(d);var g=blake2bInit(64,null);blake2bUpdate(g,d);d=blake2bFinal(g);d[0]&=248;d[31]&=127;d[31]|=64;var l=b+64;for(g=0;g<b;g++)a[64+g]=c[g];for(g=0;32>g;g++)a[32+g]=d[32+g];g=blake2bInit(64,null);blake2bUpdate(g,a.subarray(32));c=blake2bFinal(g);reduce(c);scalarbase(e,c);pack(a,e);for(g=32;64>g;g++)a[g]=h[g-32];g=blake2bInit(64,null);
blake2bUpdate(g,a);e=blake2bFinal(g);reduce(e);for(g=0;64>g;g++)f[g]=0;for(g=0;32>g;g++)f[g]=c[g];for(g=0;32>g;g++)for(h=0;32>h;h++)f[g+h]+=e[g]*d[h];modL(a.subarray(32),f);return l}
function unpackneg(a,c){var b=gf(),d=gf(),f=gf(),e=gf(),h=gf(),g=gf(),l=gf();set25519(a[2],gf1);unpack25519(a[1],c);S(f,a[1]);M(e,f,D);Z(f,f,a[2]);A(e,a[2],e);S(h,e);S(g,h);M(l,g,h);M(b,l,f);M(b,b,e);pow2523(b,b);M(b,b,f);M(b,b,e);M(b,b,e);M(a[0],b,e);S(d,a[0]);M(d,d,e);neq25519(d,f)&&M(a[0],a[0],I);S(d,a[0]);M(d,d,e);if(neq25519(d,f))return-1;par25519(a[0])===c[31]>>7&&Z(a[0],gf0,a[0]);M(a[3],a[0],a[1]);return 0}
function crypto_sign_open(a,c,b,d){var f,e=new Uint8Array(32);new Uint8Array(64);var h=[gf(),gf(),gf(),gf()],g=[gf(),gf(),gf(),gf()];if(64>b||unpackneg(g,d))return-1;for(f=0;f<b;f++)a[f]=c[f];for(f=0;32>f;f++)a[f+32]=d[f];d=blake2bInit(64,null);blake2bUpdate(d,a);d=blake2bFinal(d);reduce(d);scalarmult(h,g,d);scalarbase(g,c.subarray(32));add(h,g);pack(e,h);b-=64;if(crypto_verify_32(c,0,e,0)){for(f=0;f<b;f++)a[f]=0;return-1}for(f=0;f<b;f++)a[f]=c[f+64];return b}
var crypto_secretbox_KEYBYTES=32,crypto_secretbox_NONCEBYTES=24,crypto_secretbox_ZEROBYTES=32,crypto_secretbox_BOXZEROBYTES=16,crypto_scalarmult_BYTES=32,crypto_scalarmult_SCALARBYTES=32,crypto_box_PUBLICKEYBYTES=32,crypto_box_SECRETKEYBYTES=32,crypto_box_BEFORENMBYTES=32,crypto_box_NONCEBYTES=crypto_secretbox_NONCEBYTES,crypto_box_ZEROBYTES=crypto_secretbox_ZEROBYTES,crypto_box_BOXZEROBYTES=crypto_secretbox_BOXZEROBYTES,crypto_sign_BYTES=64,crypto_sign_PUBLICKEYBYTES=32,crypto_sign_SECRETKEYBYTES=
32,crypto_sign_SEEDBYTES=32,crypto_hash_BYTES=64;function checkLengths(a,c){if(a.length!==crypto_secretbox_KEYBYTES)throw Error("bad key size");if(c.length!==crypto_secretbox_NONCEBYTES)throw Error("bad nonce size");}function checkBoxLengths(a,c){if(a.length!==crypto_box_PUBLICKEYBYTES)throw Error("bad public key size");if(c.length!==crypto_box_SECRETKEYBYTES)throw Error("bad secret key size");}
function checkArrayTypes(){for(var a=0;a<arguments.length;a++)if(!(arguments[a]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array");}function cleanup(a){for(var c=0;c<a.length;c++)a[c]=0}nacl_randomBytes=function(a){var c=new Uint8Array(a);randombytes(c,a);return c};nacl_sign=function(a,c){checkArrayTypes(a,c);if(c.length!==crypto_sign_SECRETKEYBYTES)throw Error("bad secret key size");var b=new Uint8Array(crypto_sign_BYTES+a.length);crypto_sign(b,a,a.length,c);return b};
nacl_sign_keyPair=function(){var a=new Uint8Array(crypto_sign_PUBLICKEYBYTES),c=new Uint8Array(crypto_sign_SECRETKEYBYTES);crypto_sign_keypair(a,c);return{publicKey:a,secretKey:c}};nacl_sign_keyPair_fromSecretKey=function(a){checkArrayTypes(a);if(a.length!==crypto_sign_SECRETKEYBYTES)throw Error("bad secret key size");new Uint8Array(crypto_sign_PUBLICKEYBYTES);return{publicKey:derivePublicFromSecret(a),secretKey:new Uint8Array(a)}};
nacl_sign_keyPair_fromSeed=function(a){checkArrayTypes(a);if(a.length!==crypto_sign_SEEDBYTES)throw Error("bad seed size");for(var c=new Uint8Array(crypto_sign_PUBLICKEYBYTES),b=new Uint8Array(crypto_sign_SECRETKEYBYTES),d=0;32>d;d++)b[d]=a[d];crypto_sign_keypair(c,b,!0);return{publicKey:c,secretKey:b}};nacl_setPRNG=function(a){randombytes=a};
(function(){var a="undefined"!==typeof self?self.crypto||self.msCrypto:null;a&&a.getRandomValues?nacl_setPRNG(function(c,b){var d,f=new Uint8Array(b);for(d=0;d<b;d+=65536)a.getRandomValues(f.subarray(d,d+Math.min(b-d,65536)));for(d=0;d<b;d++)c[d]=f[d];cleanup(f)}):"undefined"!==typeof require&&(a=require("crypto"))&&a.randomBytes&&nacl_setPRNG(function(c,b){var d,f=a.randomBytes(b);for(d=0;d<b;d++)c[d]=f[d];cleanup(f)})})();
stringFromHex=function(a){a=a.toString();for(var c="",b=0;b<a.length;b+=2)c+=String.fromCharCode(parseInt(a.substr(b,2),16));return c};stringToHex=function(a){for(var c="",b=0;b<a.length;b++)c+=""+a.charCodeAt(b).toString(16);return c};parseXRBAccount=function(a){var c=a.indexOf("xrb_");if(-1!=c){a=a.slice(c,c+64);try{return keyFromAccount(a),a}catch(b){}}return!1};
dec2hex=function(a,c){c=void 0===c?null:c;for(var b=a.toString().split(""),d=[],f=[],e,h;b.length;)for(h=1*b.shift(),e=0;h||e<d.length;e++)h+=10*(d[e]||0),d[e]=h%16,h=(h-d[e])/16;for(;d.length;)f.push(d.pop().toString(16));f=f.join("");0!=f.length%2&&(f="0"+f);if(c>f.length/2)for(b=c-f.length/2,e=0;e<b;e++)f="00"+f;return f};
hex2dec=function(a){function c(d,f){var e=0,h=[];d=d.split("").map(Number);for(f=f.split("").map(Number);d.length||f.length;)e=(d.pop()||0)+(f.pop()||0)+e,h.unshift(10>e?e:e-10),e=10>e?0:1;e&&h.unshift(e);return h.join("")}var b="0";a.split("").forEach(function(d){d=parseInt(d,16);for(var f=8;f;f>>=1)b=c(b,b),d&f&&(b=c(b,"1"))});return b};hex_uint8=function(a){for(var c=a.length/2|0,b=new Uint8Array(c),d=0;d<c;d++)b[d]=parseInt(a.substr(2*d,2),16);return b};
uint8_hex=function(a){for(var c="",b,d=0;d<a.length;d++)b=a[d].toString(16).toUpperCase(),1==b.length&&(b="0"+b),c+=b;return c};uint4_hex=function(a){for(var c="",b=0;b<a.length;b++)c+=a[b].toString(16).toUpperCase();return c};function equal_arrays(a,c){for(var b=0;b<a.length;b++)if(a[b]!=c[b])return!1;return!0}accountFromHexKey=function(a){a=hex_uint8(a);var c=blake2b(a,null,5).reverse();c=encode(c);return"ban_"+encode(a)+c};bananoSeed=function(a){return uint8_hex(a)};
bananoPrivKey=function(a){var c=hex_uint8(dec2hex(0,4)),b=blake2bInit(32);blake2bUpdate(b,a);blake2bUpdate(b,c);return blake2bFinal(b)};bananoPubKey=function(a){return accountFromHexKey(uint8_hex(nacl_sign_keyPair_fromSecretKey(a).publicKey))};